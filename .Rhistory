ines_microbit <- c(71,71,67,75,72,71,70,75,73,79,96,78,
87,91,100,88,85,102,78,92,102,76,93,78,
73,80,79,88,83,79,82,87,98,89,77,78,76,79,83)
ines_watch <- c(65,77,78,75,75,78,75,75,76,82,78,81,82,70,
74,81,81,85,81,89,82,76,78,80,70,84,76,79,
91,81,83,85,89,96,88,90,79,78,80)
sheimaa_microbit <- c(86,89,75,80,89,83,67,67,67,67,67,
70,67,71,69,69,73,68,63,64,77,72,
70,67,68,68,69,72,81,69,66,65,67,
83,70,71,69,73,76,69)
sheimaa_watch <- c(74,68,65,64,65,73,62,61,65,64,67,66,
66,70,72,71,73,71,67,64,68,74,70,66,
67,69,70,72,78,66,67,65,69,71,69,
72,71,72,74,70)
summary(sheimaa_microbit)
hist(ines_microbit,col='skyblue',border=F, main = "Histogram of HR of Subject I", xlab = "Heart Rate (BPM)", breaks = 12,xlim = c(60,110),ylim = c(0,25),)
hist(ines_watch,add=T,col=scales::alpha('red',.5),border=F, breaks = 11, xlim = c(60,110), ylim = c(0,25))
legend(x = "topright", legend=c("Microbit", "Watch"),
fill = c("skyblue","salmon"), cex=0.8)
hist(sheimaa_microbit,col='skyblue',border=F, main = "Histogram of HR of Subject S", xlab = "Heart Rate (BPM)", breaks = 6, xlim = c(60,110),ylim = c(0,25),)
hist(sheimaa_watch,add=T,col=scales::alpha('red',.5),border=F, breaks = 6, xlim = c(60,110), ylim = c(0,25),)
legend(x = "topright", legend=c("Microbit", "Watch"),
fill = c("skyblue","salmon"), cex=0.8)
# Pearson Correlation
corr_ines <- cor(ines_microbit, ines_watch, method = "pearson")
corr_ines
corr_sheimaa <- cor(sheimaa_microbit, sheimaa_watch, method = "pearson")
corr_sheimaa
mean(ines_microbit)
mean_diff_ines <- mean(ines_watch) - mean(ines_microbit)
mean_diff_ines
mean(ines_watch)
mean_diff_ines
mean_diff_ines <- mean(sheimaa_watch) - mean(sheimaa_microbit)
mean_diff_sheimaa <- mean(sheimaa_watch) - mean(sheimaa_microbit)
mean_diff_sheimaa
#RMSE
rmse <- sqrt(mean((ines_watch - ines_microbit)^2))
rmse
rmse <- sqrt(mean((sheimaa_watch - sheimaa_microbit)^2))
rmse
install.packages("BlandAltmanLeh")
library(BlandAltmanLeh)
# Create Bland-Altman plot
bland.altman.plot(ines_watch, ines_microbit, graph.sys = "base")  # Use base graphics
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot")
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Bland-Altman Plot
mean_values <- (sheimaa_watch + sheimaa_microbit) / 2
differences <- sheimaa_watch - sheimaa_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot", ylim = c(-30,20))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Check variances
var(sheimaa_watch)
var(sheimaa_microbit)
# Because they have unequal variances, use Welch's t-test
t.test(sheimaa_watch, sheimaa_microbit, alternative = "two.sided", var.equal = FALSE)
# Check variances
var(sheimaa_watch)
var(sheimaa_microbit)
# Because they have unequal variances, use Welch's t-test
t.test(sheimaa_watch, sheimaa_microbit, alternative = "two.sided", var.equal = FALSE)
# T test
# Check variances
var(ines_watch)
var(ines_microbit)
# Because they have unequal variances, use Welch's t-test
t.test(ines_watch, ines_microbit, alternative = "two.sided", var.equal = FALSE)
library(effsize)
install.packages("effsize")
library(effsize)
# Calculate Cohen's d
result <- cohen.d(ines_watch, ines_microbit)
# Extract Cohen's d value
d_value <- result$estimate
# Calculate Cohen's r
r_value <- d_value / sqrt(d_value^2 + 4)
print(r_value)
result
result <- cohen.d(sheimaa_watch, sheimaa_microbit)
# Extract Cohen's d value
d_value <- result$estimate
# Calculate Cohen's r
r_value <- d_value / sqrt(d_value^2 + 4)
print(r_value)
result
# Range
range(ines_microbit)
# Range
range(ines_microbit)
range(ines_watch)
range(sheimaa_microbit)
range(sheimaa_watch)
# Range
range(ines_microbit)[0]
# Range
range(ines_microbit)[1]
# Range
range(ines_microbit)[2]
# Range
range(ines_microbit)[2] - range(ines_microbit)[1]
range(ines_watch)[2] - range(ines_watch)[1]
range(sheimaa_microbit)[2] - range(sheimaa_microbit)[1]
range(sheimaa_watch)[2] - range(sheimaa_watch)[1]
install.packages("MethodCompare")
library(MethodCompare)
# Method compare
agreement0(ines_watch, ines_microbit)
# Method compare
ines.data
agreement0(ines.data)
agreement0(ines.data$ines_mcr)
agreement0(ines.data)
# Extract Cohen's d value
d_value <- result$estimate
# Calculate Cohen's d
result <- cohen.d(ines_watch, ines_microbit)
# Calculate Cohen's d
result <- cohen.d(ines_watch, ines_microbit)
# Extract Cohen's d value
d_value <- result$estimate
d_value
# Calculate Cohen's r
r_value <- d_value / sqrt(d_value^2 + 4)
print(r_value)
result
# Create an array filled with the value 5
length(ines_microbit)
# Create an array filled with the value 5
length(ines_microbit)
length(ines_watch)
my_array <- array(1, dim = 40)  # A 3x3x2 array
print(my_array)
microbit_vals <- array(1, dim = 40)  # A 3x3x2 array
print(my_array)
print(watch_vals)
watch_vals <- array(1, dim = 40)
print(watch_vals)
watch_vals <- array(0, dim = 40)
print(watch_vals)
hist(sheimaa_microbit,col='skyblue',border=F, main = "Histogram of HR of Subject S", xlab = "Heart Rate (BPM)", breaks = 6, xlim = c(60,110),ylim = c(0,25),)
group1 <- data.frame(hr = ines_microbit, name = microbit_vals)
group1 <- data.frame(hr = ines_microbit, name = microbit_vals)
# Create an array filled with the value 5
length(ines_microbit)
length(ines_watch)
microbit_vals <- array(1, dim = 39)
print(microbit_vals)
watch_vals <- array(0, dim = 39)
print(watch_vals)
# Create an array filled with the value 5
length(ines_microbit)
length(ines_watch)
microbit_vals <- array(1, dim = 39)
print(microbit_vals)
watch_vals <- array(0, dim = 39)
print(watch_vals)
group1 <- data.frame(hr = ines_microbit, name = microbit_vals)
group2 <- data.frame(hr = ines_watch, name = watch_vals)
# Calculate standardized difference for numeric variable
stddiff.numeric(group1$hr, group2$hr)
# Calculate standardized difference for numeric variable
stddiff.numeric(group1$hr, group2$hr)
install.packages("stddiff")
library(stddiff)
# Calculate standardized difference for numeric variable
stddiff.numeric(group1$hr, group2$hr)
# Calculate standardized difference for numeric variable
stddiff.numeric(group1$hr, group2$hr)
stddiff.numeric(data=group1,gcol=1,vcol=c(2,2))
total <- merge(group1,group2,by="name")
total
total
total <- rbind(group1, group2)
total
stddiff.numeric(data=total,gcol=1,vcol=2)
,2
stddiff.numeric(data=total,gcol=1,vcol=c(2,2))
stddiff.numeric(data=total,gcol=2,vcol=1)
# Create an array filled with the value 5
length(sheimaa_microbit)
length(sheimaa_watch)
microbit_vals <- array(1, dim = 39)
print(microbit_vals)
watch_vals <- array(0, dim = 39)
print(watch_vals)
group1 <- data.frame(hr = sheimaa_microbit, name = microbit_vals)
# Create an array filled with the value 5
length(sheimaa_microbit)
length(sheimaa_watch)
microbit_vals <- array(1, dim = 40)
print(microbit_vals)
watch_vals <- array(0, dim = 40)
print(watch_vals)
group1 <- data.frame(hr = sheimaa_microbit, name = microbit_vals)
group2 <- data.frame(hr = sheimaa_watch, name = watch_vals)
total <- rbind(group1, group2)
total
stddiff.numeric(data=total,gcol=2,vcol=1)
corr_ines <- cor(ines_microbit, ines_watch, method = "pearson")
corr_ines
corr_sheimaa <- cor(sheimaa_microbit, sheimaa_watch, method = "pearson")
corr_sheimaa
library(ggplot2)
library(dplyr)
install.packages("BlandAltmanLeh")
library(BlandAltmanLeh)
install.packages("effsize")
install.packages("MethodCompare")
library(effsize)
library(MethodCompare)
install.packages("stddiff")
library(stddiff)
library(ggplot2)
library(dplyr)
install.packages("BlandAltmanLeh")
install.packages("BlandAltmanLeh")
ines_microbit <- c(71,71,67,75,72,71,70,75,73,79,96,78,
87,91,100,88,85,102,78,92,102,76,93,78,
73,80,79,88,83,79,82,87,98,89,77,78,76,79,83)
ines_watch <- c(65,77,78,75,75,78,75,75,76,82,78,81,82,70,
74,81,81,85,81,89,82,76,78,80,70,84,76,79,
91,81,83,85,89,96,88,90,79,78,80)
sheimaa_microbit <- c(86,89,75,80,89,83,67,67,67,67,67,
70,67,71,69,69,73,68,63,64,77,72,
70,67,68,68,69,72,81,69,66,65,67,
83,70,71,69,73,76,69)
sheimaa_watch <- c(74,68,65,64,65,73,62,61,65,64,67,66,
66,70,72,71,73,71,67,64,68,74,70,66,
67,69,70,72,78,66,67,65,69,71,69,
72,71,72,74,70)
summary(sheimaa_microbit)
# Summary statistics
summary(sheimaa_microbit)
summary(sheimaa_microbit)
# Standard Deviation
sd(ines_watch)
# Standard Deviation
sd(ines_microbit)
# Standard Deviation
sd(sheimaa_watch)
# Standard Deviation
sd(sheimaa_microbit)
mean_diff_ines <- bias <- mean(ines_watch - ines_microbit)
mean_diff_ines
mean_diff_ines  <- mean(ines_watch - ines_microbit)
mean_diff_ines
mean_diff  <- mean(ines_watch - ines_microbit)
mean_diff
mean_diff2  <- mean(sheimaa_watch - sheimaa_microbit)
mean_diff2
# Because they have unequal variances, use Welch's t-test
t.test(sheimaa_watch, sheimaa_microbit, alternative = "two.sided", var.equal = FALSE)
# Because they have unequal variances, use Welch's t-test
t.test(ines_watch, ines_microbit, alternative = "two.sided", var.equal = FALSE)
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject I", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Bland-Altman Plot
mean_values <- (sheimaa_watch + sheimaa_microbit) / 2
differences <- sheimaa_watch - sheimaa_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject S", ylim = c(-30,20))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject S", ylim = c(-30,20))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean(differences) + 1.96 * sd(differences)
mean(differences) - 1.96 * sd(differences)
# Bland-Altman plots
# Calculate mean and difference
mean_values <- (ines_watch + ines_microbit) / 2
differences <- ines_watch - ines_microbit
# Plot
plot(mean_values, differences,
xlab = "Mean of Two Methods",
ylab = "Difference Between Methods",
main = "Bland-Altman Plot Subject I", ylim = c(-30,30))
abline(h = mean(differences), col = "blue")  # Mean difference
abline(h = mean(differences) + 1.96 * sd(differences), col = "red", lty = 2)  # Upper limit
abline(h = mean(differences) - 1.96 * sd(differences), col = "red", lty = 2)  # Lower limit
mean(differences) - 1.96 * sd(differences)
mean(differences) + 1.96 * sd(differences)
install.packages("RSiena")
install.packages("jtools")
install.packages("lmerTest")
library(effects)
library(ggplot2)
library(lme4)
library(RSiena)
library(jtools)
library(lmerTest)
library(boot)
data <- read.csv("data/Data_T2.csv")
getwd()
setwd("2025")
setwd("KTH/Studies/Statistics for Medical Engineering/Seminar 3")
setwd("cm2018_ht25_seminar_3_b2")
# Read data
data <- read.csv("data/Data_T2.csv")
str(data)
xeno_group <- data[data$Model == 1,]
tumor_group <- data[data$Model ==0,]
control_group <- data[data$Treatment == 0,]
treated_group <- data[data$Treatment == 1,]
# Read data
data <- read.csv("data/Data_T2.csv")
xeno_group <- data[data$Model == 1,]
tumor_group <- data[data$Model ==0,]
control_group <- data[data$Treatment == 0,]
treated_group <- data[data$Treatment == 1,]
control_xeno <- control_group[control_group$Model==1,]
treated_xeno <- treated_group[treated_group$Model==1,]
control_tumor <- control_group[control_group$Model==0,]
treated_tumor <- treated_group[treated_group$Model==0,]
ggplot(data=control_xeno, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() +  scale_color_discrete(name = "ID") +
ggtitle("Control Xenograph Mice") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=treated_xeno, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() + scale_color_discrete(name = "ID") +
ggtitle("Treated Xenograph Mice") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=control_xeno, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() +  scale_color_discrete(name = "ID") +
ggtitle("Control Xenograft Mice") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=treated_xeno, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() + scale_color_discrete(name = "ID") +
ggtitle("Treated Xenograft Mice") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=control_tumor, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() + scale_color_discrete(name = "ID") +
ggtitle("Control Tumor Mice") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(data=treated_tumor, aes(x=Time, y=DV, group=as.factor(ID), colour = as.factor(ID))) +
geom_line(linetype = "dashed")+
geom_point() + scale_color_discrete(name = "ID") +
ggtitle("Treated Tumor Mice") +
theme(plot.title = element_text(hjust = 0.5))
# Plot of histograms of different Model's DV for each Treatment
# 0 = Tumor Group, 1 = Xenograft Group
p1 <- ggplot(treated_group, aes(x=ID, y=DV, group=ID,  color = as.factor(Model))) +
scale_color_discrete(name = "Model") +
geom_boxplot() +
facet_wrap(~Model) + ggtitle("Histograms of Treated Group") +
theme(plot.title = element_text(hjust = 0.5))
p1
p2 <- ggplot(control_group, aes(x=ID, y=DV, group=ID,  color = as.factor(Model))) +
scale_color_discrete(name = "Model") +
geom_boxplot() +
facet_wrap(~Model) + ggtitle("Histograms of Control Group") +
theme(plot.title = element_text(hjust = 0.5))
p2
# Plot of histograms of different Treatment's DV for each Model
p3 <- ggplot(xeno_group, aes(x=ID, y=DV, group=ID,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() +
facet_wrap(~Treatment) + ggtitle("Histograms of Xenograft Group") +
theme(plot.title = element_text(hjust = 0.5))
p3
p4 <- ggplot(tumor_group, aes(x=ID, y=DV, group=ID,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() +
facet_wrap(~Treatment) + ggtitle("Histograms of Tumor Group") +
theme(plot.title = element_text(hjust = 0.5))
p4
# Boxplot of avg
p5 <- ggplot(tumor_group, aes(x=ID, y=DV,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() +
ggtitle("Histograms of Tumor Group") +
theme(plot.title = element_text(hjust = 0.5))
p5
# Boxplot of avg
p6 <- ggplot(xeno_group, aes(x=ID, y=DV,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() +
ggtitle("Histograms of Xenograft Group") +
theme(plot.title = element_text(hjust = 0.5))
p6
# Boxplot over time for each category
p6 <- ggplot(xeno_group, aes(x=Time, y=DV, group = Time,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() + facet_wrap(~Treatment) +
ggtitle("Histograms of Xenograft Group over Time") +
theme(plot.title = element_text(hjust = 0.5))
p6
# Boxplot over time for each category
p7 <- ggplot(tumor_group, aes(x=Time, y=DV, group = Time,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() + facet_wrap(~Treatment) +
ggtitle("Histograms of Tumor Group over Time") +
theme(plot.title = element_text(hjust = 0.5))
p7
m1_fe1 <- lm(formula = DV ~ Treatment + factor(ID)-1, data = tumor_group)
plot(m1_fe1)
summary(m1_fe1)
# Mixed effects model treatment w/ pooling (tumor group)
m2_lme <- lmer(DV~1 + Treatment + (1|ID), tumor_group)
summary(m2_lme)
plot(m2_lme)
summary(m2_lme)
plot(m2_lme)
summ(m2_lme)
ranova(m2_lme)
# Plot of histograms of different Treatment's DV for each Model
p3 <- ggplot(xeno_group, aes(x=ID, y=DV, group=ID,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() +
facet_wrap(~Treatment) + ggtitle("Histograms of Xenograft Group") +
theme(plot.title = element_text(hjust = 0.5))
p3
# Likelihood ratio test tumor group
m_null <- lmer(DV~1 + (1|ID), tumor_group, REML = FALSE)
m_treat <- lmer(DV~1 + Treatment + (1|ID), tumor_group, REML = FALSE)
anova(m_null, m_treat)
# Effect Plot
plot(allEffects(m2_lme))
# Bootstrap
confint(m2_lme, parm = c(3,4), method ="boot", nsim = 1000, boot.type = "perc")
# ----- Conditional growth model ----
model_tumor <- lmer(DV ~ 1 + Treatment * Time + (1 + Time | ID), tumor_group)
summary(model_tumor)
summ(model_tumor)
plot(allEffects(model_tumor))
plot(allEffects(model_tumor))
model_xeno <- lmer(DV ~ 1 + Treatment * Time + (1 + Time | ID), xeno_group)
summ(model_xeno)
# ----- Conditional growth model ----
model_tumor <- lmer(DV ~ 1 + Treatment * Time + (1 + Time | ID), tumor_group)
summary(model_tumor)
summ(model_tumor)
# Boxplot over time for each category
p7 <- ggplot(tumor_group, aes(x=Time, y=DV, group = Time,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() + facet_wrap(~Treatment) +
ggtitle("Histograms of Tumor Group over Time") +
theme(plot.title = element_text(hjust = 0.5))
p7
# Boxplot over time for each category
p6 <- ggplot(xeno_group, aes(x=Time, y=DV, group = Time,  color = as.factor(Treatment))) +
scale_color_discrete(name = "Treatment") +
geom_boxplot() + facet_wrap(~Treatment) +
ggtitle("Histograms of Xenograft Group over Time") +
theme(plot.title = element_text(hjust = 0.5))
p6
